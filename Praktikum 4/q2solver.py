from Crypto.Util.number import long_to_bytes
import gmpy2

# nilai 
n = 15759615042180649041596658287668414489189077112235860100211911115250431302849683276285731106548115937638289979087969524234208611870710633515079991373663766423874055118662541824187955220440397928304236310603796796313625606897016057576744677359943486392344503145709579678674348318782229297647714174217516018694539007160608944430937034544250573079612716803553232903441662736871400867227470549648830376257722171953827226464889796516771624865677860133545288603942196828709012321175773472875667188338169400264134585468501056099033472619127264375071663751561759303474430334279790862834581749708954285104699644046613927076737
c = 2344291097829188983579466594189698282383664262684774986896537805572522683128055047748300247696394242490422027188454859807664457337978658793000777936459309009372856166671075431096156773955444505970263472075618053238322211277550632944972952128574619481153303321045511668987706883106816408769713058690096813388100618801583589770113565361941160389675526436558849335309158887629222188384623313561824109056628841144631219564014897602033727802336373408793274102135597864
g = 12050955267775767537568470242064572761840816042113877738976273507498444199871887767403180170097289251517250563450741923892010644458668065104572122677069707
A = 4454616487663596538806517973478271079131182042349146941797659062793031468845492590250220972656964845848862358234779851686655635425033976780511424646136324
B = 4124156168261670138441671835404469967345593457632202994459118983978680881665901731998435347814290648119083726613759685795578080384055344519189024908147976

# 1) turunkan shared secret (eksploitasi XOR bug)
shared_int = g ^ (A ^ B)

# 2) ambil integer cube root dari c => flag2
root, exact = gmpy2.iroot(c, 3)
if exact:
    flag2 = int(root)
elif pow(int(root), 3, n) == c:
    flag2 = int(root)
elif pow(int(root)+1, 3, n) == c:
    flag2 = int(root) + 1
else:
    raise SystemExit("gagal menemukan flag2 (c bukan pangkat-3 sempurna)")

# 3) balik XOR untuk dapat flag, lalu cetak
flag = long_to_bytes(flag2 ^ shared_int)
print(flag.decode(errors="ignore"))
